
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Neural networks, Part 1: Linear logic functions as networks &#8212; Models of the Mind</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '11_nnets-01-linear-functions-and-bias';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Neural networks, Part 2 – training networks" href="12_nnets-02-training-linear-networks.html" />
    <link rel="prev" title="Network Science Overview" href="10_netsci-01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Models of the Mind - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Models of the Mind - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    models-of-the-mind-notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_python-jupyter-overview.html">Models of the Mind, 2024</a></li>



<li class="toctree-l1"><a class="reference internal" href="01_game-of-life.html">Conway’s “Game of Life”</a></li>

<li class="toctree-l1"><a class="reference internal" href="02a_math-probability-matching.html"><font color="red">LAB REPORT</font></a></li>


<li class="toctree-l1"><a class="reference internal" href="02b_math-probability-matching.html">PROBABILITY MATCHING, PART 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_agent-probability-matching.html">PROBABILITY MATCHING, PART 3</a></li>




<li class="toctree-l1"><a class="reference internal" href="04_probability-review.html">Preliminaries: Understanding Logical Symbols in Probability</a></li>








<li class="toctree-l1"><a class="reference internal" href="05_bayes-theorem.html">Introduction to Bayes’ theorem</a></li>








<li class="toctree-l1"><a class="reference internal" href="05_bayes-theorem-rev.html">Introduction to Bayes’ theorem</a></li>








<li class="toctree-l1"><a class="reference internal" href="06_pseudo-swr-analysis.html">More on mathematical models: Statistical models</a></li>


<li class="toctree-l1"><a class="reference internal" href="07_swr-bayes-004.html">Introduction</a></li>





<li class="toctree-l1"><a class="reference internal" href="08_trace-swr.html">Implementations of the TRACE model</a></li>


<li class="toctree-l1"><a class="reference internal" href="10_netsci-01.html">Network Science Overview</a></li>








<li class="toctree-l1 current active"><a class="current reference internal" href="#">Neural networks, Part 1: Linear logic functions as networks</a></li>


<li class="toctree-l1"><a class="reference internal" href="12_nnets-02-training-linear-networks.html">Neural networks, Part 2 – training networks</a></li>

<li class="toctree-l1"><a class="reference internal" href="13_nnets-03-learning-xor.html">Neural networks, Part 3 – training networks for non-linearly separable mappings</a></li>



<li class="toctree-l1"><a class="reference internal" href="14_nnets-04-srn-statlearn.html">Neural networks, Part 4</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F11_nnets-01-linear-functions-and-bias.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/11_nnets-01-linear-functions-and-bias.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Neural networks, Part 1: Linear logic functions as networks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Neural networks, Part 1: Linear logic functions as networks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-1-mystery-network"><font color="red">Lab question 1: mystery network</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-aside">An aside</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-visualize-visualize">Visualize, visualize, visualize</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-logical-function-networks">Back to logical function networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#or">OR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#truth-table-for-nonexclusive-or">Truth table for nonexclusive OR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-network-for-nonexclusive-or">A network for nonexclusive OR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-2"><font color="red">Lab question 2</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-network-outputs">Checking the network outputs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-and-network">An AND network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-3"><font color="red">Lab question 3</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Checking the network outputs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-nand-network">A NAND network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nand-truth-tables">NAND truth tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-4"><font color="red">Lab question 4</font></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-concept-of-bias-nodes">Introducing the concept of <font color="red">Bias</font> nodes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-bias-nodes-in-neural-networks">Understanding bias nodes in neural networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-for-bias-nodes">Parameters for bias nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-and">Example: AND</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bias-to-set-thresholds">Using Bias to Set Thresholds</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nand-with-a-bias-node">NAND with a bias node</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bias-to-set-thresholds-reprised">Using Bias to Set Thresholds, reprised</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-role-of-bias-in-a-2d-problem">Understanding the Role of Bias in a 2D Problem</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equation-of-a-line-2d">Equation of a Line (2D)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#without-bias">Without bias</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-without-bias">Limitations without bias</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#with-bias">With bias</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overcoming-limitations-with-bias">Overcoming limitations with bias</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-example">Python example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-this-have-to-do-with-logic">What does this have to do with logic?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nand-decision-space">NAND decision space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#or-decision-space">OR decision space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-5"><font color="red">Lab question 5</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-tangent-more-implications-of-bias">A tangent: more implications of bias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-squared-error-mse">Mean Squared Error (MSE)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-formula-to-calculate-mse-is">The formula to calculate MSE is:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-6"><font color="red">Lab question 6</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions-about-bias">Conclusions about bias</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="alert alert-block alert-info">
This tutorial includes 6 lab questions. The questions have headers like <font color='red'><b>Lab question 1</b></font> in red font. Answer all 6 questions. There are no challenge questions in this notebook. Submit your answers via WebCT and remember to paste in the question text (that really helps me grade faster!).  
</div><section class="tex2jax_ignore mathjax_ignore" id="neural-networks-part-1-linear-logic-functions-as-networks">
<h1>Neural networks, Part 1: Linear logic functions as networks<a class="headerlink" href="#neural-networks-part-1-linear-logic-functions-as-networks" title="Link to this heading">#</a></h1>
<p>In this tutorial, we are going to start building networks that implement logical functions. This is going to pave the way for more interesting and advanced topics. We are going to find that it becomes hard to build networks by hand for anything but the simplest functions. However, we can use methods for training networks that are capable of <em>discovering</em> effective weights (through trial and error – lots of trials and lots of errors!).</p>
<p>Let’s start by building some simple networks. Here’s one to start things off.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">neuron_text</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="c1"># Drawing a neuron with label and black outline</span>
    <span class="n">circle</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.18</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">,</span> <span class="n">neuron_text</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">weight</span><span class="p">):</span>
    <span class="c1"># Drawing a directed arrow with weight label</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">))</span>
    <span class="n">mid</span> <span class="o">=</span> <span class="p">((</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Calculate angle for text rotation</span>
    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">dx</span><span class="p">))</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">angle</span><span class="p">)</span>

<span class="c1"># Creating the figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>  <span class="c1"># Ensures the circles are perfectly round</span>

<span class="c1"># Draw Neurons with Labels</span>
<span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Decision&#39;</span><span class="p">)</span>
<span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 1&#39;</span><span class="p">)</span>
<span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 2&#39;</span><span class="p">)</span>

<span class="c1"># Add Threshold Label in Red Below the Decision Node</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="s1">&#39;Threshold = 1.5&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Draw Connections with Weights</span>
<span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.35</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">),</span> <span class="s1">&#39;weight1 = 1.0&#39;</span><span class="p">)</span>
<span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.35</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">),</span> <span class="s1">&#39;weight2 = 1.0&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5b3c90b2f02bae38a0ed11c0e0203712e9302e476eb775d9f9aea3964684ef19.png" src="_images/5b3c90b2f02bae38a0ed11c0e0203712e9302e476eb775d9f9aea3964684ef19.png" />
</div>
</div>
<section id="lab-question-1-mystery-network">
<h2><font color='red'>Lab question 1: mystery network</font><a class="headerlink" href="#lab-question-1-mystery-network" title="Link to this heading">#</a></h2>
<p>Can you figure out what function the network above implements? You can do some mental simulations to work it out. Imagine we give the network the inputs 1 and 0. What is the resulting activation of the Decision node? Since both weights are set to 1.0, we simply do <span class="math notranslate nohighlight">\((1 \cdot 1) + (0 \cdot 1) =\ \rule{.5cm}{0.15mm}\)</span>. Now we ask: is this result larger than 1.5? If not, the Decision node value will be set to zero. It will be set to 1 if the input is greater than the threshold. What would the network do if you gave it outputs of 0,1 or 1,1? Given this, what logical function does the network implement?</p>
<p><em>Try to answer this without looking ahead. If you get stuck, read on and come back to this later.</em></p>
</section>
<hr class="docutils" />
<section id="an-aside">
<h2>An aside<a class="headerlink" href="#an-aside" title="Link to this heading">#</a></h2>
<p>We will come back to networks shortly, but before we do, let’s get set up to be able to do more complex network diagrams.</p>
</section>
<hr class="docutils" />
<section id="visualize-visualize-visualize">
<h2>Visualize, visualize, visualize<a class="headerlink" href="#visualize-visualize-visualize" title="Link to this heading">#</a></h2>
<p>My mantra with any kind of data or mechanism is <em>visualize, <strong>visualize</strong>, visualize</em>. If you do not visualize data, you can be badly led astray. You may make assumptions and not realize they are not valid. You might miss some obvious pattern or problem in your data that visualization can reveal.</p>
<p>It can also be super helpful to image / visualize networks and details like connection weights. When we do this, it can help us understand the functional implications of the network architecture.</p>
<p>For a small network, we can create a diagram of the network that also displays weights as text annotations. For very large networks, we might need to consider things like ‘heatmap’ plots of weight matrices. But we will be working with fairly small networks for now, so let’s start with the diagram approach.</p>
<p>I created some functions in python to give us simple plots of networks. The functions are in <code class="docutils literal notranslate"><span class="pre">network_plotter.py</span></code>. You define a data structure that defines your network. It’s a nested list where each ‘column’ is a list of nodes in a layer (e.g., ‘Input 1’, ‘Input 2’). For layers (columns) with more than 1 node, it spreads them across the vertical extent of the layer with the most nodes. If there is just 1 node, it centers it vertically. Then it can draw connections between nodes. If you define weights for the nodes, it can print the weights at random positions along the arrow connecting nodes (using random positions usually succeeds in avoiding weights being printed on top of each other).</p>
<p>You also have options to make connections ‘bow’ or bend. This is particularly useful if you have feedback connections where you also have feedforward connections; you can make the feedback connections bow so they are not on top of the feedforward connections. By default, if you do not specify an <code class="docutils literal notranslate"><span class="pre">edge_color</span></code> for feedback connections, they will be red. Here’s an elaborate example, where we generate random connection weights in a network with 2 inputs, 4 hidden nodes, and 1 output nodes. Feedforward layers are fully connected (every node in a lower layer has a connection to every node in the next layer). In addition, there are feedback connections from the output node to the first and last hidden nodes, and from the first hidden node to the first input node.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">network_plotter</span> <span class="k">as</span> <span class="nn">netplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>

<span class="n">plot_width</span><span class="o">=</span><span class="mf">10.0</span>
<span class="n">plot_height</span> <span class="o">=</span> <span class="n">plot_width</span>
<span class="n">fig_width</span><span class="o">=</span><span class="n">plot_width</span><span class="o">*</span><span class="mf">1.2</span>
<span class="n">fig_height</span> <span class="o">=</span> <span class="n">fig_width</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span> 

<span class="c1"># Node / layers definition</span>
<span class="n">layers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Input 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Hid 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hid 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hid 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hid 4&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Output&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Generate random weights based on the size of layers</span>
<span class="c1">#np.random.seed(0)  # For reproducibility</span>
<span class="n">input_to_hidden_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># Weights from inputs to hidden nodes</span>
<span class="n">hidden_to_output_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># Weights from hidden nodes to the output node</span>


<span class="c1"># Creating the figure with specified size</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>  <span class="c1"># Adjust aspect ratio to fit the plot_width</span>

<span class="c1"># Calculate node positions with the specified plot width</span>
<span class="n">node_positions</span> <span class="o">=</span> <span class="n">netplot</span><span class="o">.</span><span class="n">calculate_node_positions</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">plot_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span> <span class="c1"># , offset=0.3)</span>

<span class="c1"># Draw Neurons with Labels</span>
<span class="n">num_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
<span class="n">subtext</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="n">nodetext</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">node_positions</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">num_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">subtext</span><span class="o">=</span><span class="s1">&#39;Decision&#39;</span>
            <span class="n">nodetext</span> <span class="o">=</span> <span class="s1">&#39;1.0&#39;</span>
        <span class="n">netplot</span><span class="o">.</span><span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_layers</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">,</span> <span class="n">subtext</span><span class="o">=</span><span class="n">subtext</span><span class="p">,</span> <span class="n">nodetext</span><span class="o">=</span><span class="n">nodetext</span><span class="p">)</span>

<span class="c1"># Draw Connections with Weights</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">input_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">hidden_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">input_to_hidden_weights</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions</span><span class="p">,</span> <span class="n">input_node</span><span class="p">,</span> <span class="n">hidden_node</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span>

<span class="c1"># Draw connections from hidden nodes to the decision node</span>
<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">hidden_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">bow</span><span class="o">=</span><span class="kc">False</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">hidden_to_output_weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="c1"># uncomment next line to make one connection bowed</span>
    <span class="c1">#bow = hidden_node == &#39;Hid 4&#39;  # Only bow the connection for Hidden4</span>
    <span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions</span><span class="p">,</span> <span class="n">hidden_node</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bow</span><span class="o">=</span><span class="n">bow</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span>
  
<span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="s1">&#39;Hid 4&#39;</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span> <span class="c1"># , edge_color=&#39;pink&#39;)</span>
<span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="s1">&#39;Hid 1&#39;</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span> <span class="c1"># , edge_color=&#39;pink&#39;)</span>
<span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions</span><span class="p">,</span> <span class="s1">&#39;Hid 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 1&#39;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span> <span class="c1"># , edge_color=&#39;pink&#39;)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#print(input_to_hidden_weights)</span>
<span class="c1">#print(hidden_to_output_weights)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e5ee4dd5d37a9eeaa489b705c5f56ef5b13d6eadec635573ecc3f3f62f67a794.png" src="_images/e5ee4dd5d37a9eeaa489b705c5f56ef5b13d6eadec635573ecc3f3f62f67a794.png" />
</div>
</div>
<p>There are some other ‘neatening’ touches, like putting labels for the first column to the left of nodes, and labels for the last column to the right, with labels for intermediate nodes above the nodes. You can also toggle labels on and off for both nodes and links / edges. If you print the weights next to the links, the positions are set to random positions along the edge to try to avoid weights being printed on top of each other. If you are unhappy with the weight text placement, you can regenerate it just by clicking in the code block and hitting the ‘play’ / ‘execute’ icon. (Note that the labels for feedback connections are not randomly nudged at all, but could be.) You can also specify a ‘subtext’ for any node when it is drawn; in the example below, ‘Decision’ is added as subtext for any node in the last layer. You can also specify ‘nodetext’ which will be printed in the center of a node. This could be activation values, or the threshold for the node to fire, for example. In the code below, a value of 1.0 is printed inside any output node.</p>
<p>Some minor blemishes: to keep feedback nodes from obscuring feedforward nodes, the start and end positions of bowed connections are shifted slightly. This usually works okay, but it’s not perfect. Weight text is usually above lines but occasionally touch lines. To change the plot size, just change plot_width. There may be some plot sizes where things won’t work perfectly. Annoyingly, I can only get the nodes to plot as circles when the aspect ratio for the whole plot is 1:1 (node aspect ratio is same as plot aspect ratio, so if the plot is twice as wide as it is tall, the nodes will also be twice as wide as they are tall).</p>
<p>However, because the ‘nudges’ are random, just re-running the codeblock above will give you a new graph, and you can just keep running it until it is good enough…</p>
</section>
<hr class="docutils" />
<section id="back-to-logical-function-networks">
<h2>Back to logical function networks<a class="headerlink" href="#back-to-logical-function-networks" title="Link to this heading">#</a></h2>
<p>Now let’s work towards making networks that can implement (nonexclusive) OR, AND, NAND, and XOR (exclusive or). Let’s start with a network that can implement OR.</p>
</section>
<hr class="docutils" />
<section id="or">
<h2>OR<a class="headerlink" href="#or" title="Link to this heading">#</a></h2>
<p>The OR function is one of our basic operations in boolean logic. It’s useful for logic, but also applications like building digital circuits. It takes two boolean inputs and returns a true value if at least one of the inputs is true. The function is often symbolized as <span class="math notranslate nohighlight">\(\vee\)</span>  or (usually in programming languages) as <span class="math notranslate nohighlight">\(\parallel\)</span> (and sometimes <code class="docutils literal notranslate"><span class="pre">|</span></code>).</p>
</section>
<section id="truth-table-for-nonexclusive-or">
<h2>Truth table for nonexclusive OR<a class="headerlink" href="#truth-table-for-nonexclusive-or" title="Link to this heading">#</a></h2>
<p>In a ‘truth table’, we simply list out the possible input states and resulting output states. Here is the truth table for the OR function:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Output (A OR B)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
</tr>
</tbody>
</table>
</div>
<p>The output is only false when both inputs are false.</p>
<p>We can rewrite this using numbers, where 0 = False and 1 = True.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Output (A OR B)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
</div>
<p>Note that we can extend this to arbitrarily many inputs, though we will stick with 2 inputs for now. But just to illustrate, here’s a truth table nonexclusive OR with 3 inputs. Again, there is only 1 case where the output will be False. Make sure you understand why. If it’s not clear, ask me!</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Input C</p></th>
<th class="head text-center"><p>Output (A OR B OR C)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="a-network-for-nonexclusive-or">
<h2>A network for nonexclusive OR<a class="headerlink" href="#a-network-for-nonexclusive-or" title="Link to this heading">#</a></h2>
<p>Now let’s make a diagram, using the <code class="docutils literal notranslate"><span class="pre">network_plotter.py</span></code> library file (which we load via <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">network_plotter</span> <span class="pre">as</span> <span class="pre">netplot</span></code>). The network will be wider than I’d like, but currently, this is best we can do with the library and a small network. Run the next code block to see the network. Note that if we change the threshold on the output to be 1 if the input is greater than 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">network_plotter</span> <span class="k">as</span> <span class="nn">netplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Setup for plot</span>
<span class="n">plot_width</span> <span class="o">=</span> <span class="mf">8.0</span>
<span class="n">plot_height</span> <span class="o">=</span> <span class="n">plot_width</span>
<span class="n">fig_width</span> <span class="o">=</span> <span class="n">plot_width</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">fig_height</span> <span class="o">=</span> <span class="n">fig_width</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Define a simpler network for the OR function</span>
<span class="n">layers_or</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Input 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Output&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Set weights for the OR function (both to 1.0)</span>
<span class="n">input_to_output_weights_or</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>  <span class="c1"># Weights from inputs to the output node</span>

<span class="c1"># Creating the figure for the OR network</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

<span class="c1"># Calculate node positions for the OR network</span>
<span class="n">node_positions_or</span> <span class="o">=</span> <span class="n">netplot</span><span class="o">.</span><span class="n">calculate_node_positions</span><span class="p">(</span><span class="n">layers_or</span><span class="p">,</span> <span class="n">plot_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Draw Neurons with Labels for the OR network</span>
<span class="n">num_layers_or</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers_or</span><span class="p">)</span>
<span class="n">subtext_or</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">nodetext_or</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_or</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">node_positions_or</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">num_layers_or</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">subtext_or</span> <span class="o">=</span> <span class="s1">&#39;Threshold: 0.0&#39;</span>
            <span class="n">nodetext_or</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">netplot</span><span class="o">.</span><span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_layers_or</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">,</span> <span class="n">subtext</span><span class="o">=</span><span class="n">subtext_or</span><span class="p">,</span> <span class="n">nodetext</span><span class="o">=</span><span class="n">nodetext_or</span><span class="p">)</span>

<span class="c1"># Draw Connections with Weights for the OR network</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">input_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_or</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">input_to_output_weights_or</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions_or</span><span class="p">,</span> <span class="n">input_node</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;OR network with threshold&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e8adba610054ebb38d1c88eead059f5f96bc85dbac7f3dfbc50aa11c7829dc5c.png" src="_images/e8adba610054ebb38d1c88eead059f5f96bc85dbac7f3dfbc50aa11c7829dc5c.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="lab-question-2">
<h2><font color='red'>Lab question 2</font><a class="headerlink" href="#lab-question-2" title="Link to this heading">#</a></h2>
<p>(a) Explain how this network implements OR. Remember, when we set a threshold, it means that if the input exceeds that value, the node will have an activation of 1.0; otherwise, it will have an activation of 0.0.</p>
<p>(b) Generate a different set of weights that will give the same result; you can change the threshold if you like, but you don’t need to (that is, there are different weights that will work with the 0.0 threshold).</p>
</section>
<hr class="docutils" />
<section id="checking-the-network-outputs">
<h2>Checking the network outputs<a class="headerlink" href="#checking-the-network-outputs" title="Link to this heading">#</a></h2>
<p>We can write a simple function to test the outputs this network will give to all possible 1,0 combinations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">or_network</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">,</span> <span class="n">weight1</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">weight2</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="c1">#weight1, weight2 = 1.0, 1.0  # Weights for the input nodes</span>
    <span class="c1">#threshold = 0.0  # Threshold for activation</span>

    <span class="c1"># Compute the weighted sum</span>
    <span class="n">weighted_sum</span> <span class="o">=</span> <span class="n">input1</span> <span class="o">*</span> <span class="n">weight1</span> <span class="o">+</span> <span class="n">input2</span> <span class="o">*</span> <span class="n">weight2</span>

    <span class="c1"># Check if the weighted sum meets or exceeds the threshold</span>
    <span class="n">myoutput</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">weighted_sum</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">myoutput</span>

<span class="c1"># Test the network on all possible input combinations</span>
<span class="n">input_combinations</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="n">input_combinations</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">or_network</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="n">inputs</span><span class="si">}</span><span class="s2">, Output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input: (0, 0), Output: 0
Input: (0, 1), Output: 1
Input: (1, 0), Output: 1
Input: (1, 1), Output: 1
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="an-and-network">
<h2>An AND network<a class="headerlink" href="#an-and-network" title="Link to this heading">#</a></h2>
<p>Now let’s tackle AND. Here’s the truth table:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Output (A AND B)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
</tr>
</tbody>
</table>
</div>
<p>The output is true only when both inputs are true.</p>
<p>Here it is rewritten with 1s and 0s.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Output (A AND B)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
</div>
<p>Now let’s try to make a network that can implement the AND function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">network_plotter</span> <span class="k">as</span> <span class="nn">netplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Setup for the AND network plot</span>
<span class="n">plot_width</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">plot_height</span> <span class="o">=</span> <span class="n">plot_width</span>
<span class="n">fig_width</span> <span class="o">=</span> <span class="n">plot_width</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">fig_height</span> <span class="o">=</span> <span class="n">fig_width</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Define the network for the AND function</span>
<span class="n">layers_and</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Input 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Output&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Set weights for the AND function</span>
<span class="c1"># Both inputs need to be 1 to exceed the threshold of 1.5</span>
<span class="n">input_to_output_weights_and</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

<span class="c1"># Creating the figure for the AND network</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

<span class="c1"># Calculate node positions for the AND network</span>
<span class="n">node_positions_and</span> <span class="o">=</span> <span class="n">netplot</span><span class="o">.</span><span class="n">calculate_node_positions</span><span class="p">(</span><span class="n">layers_and</span><span class="p">,</span> <span class="n">plot_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Draw Neurons with Labels for the AND network</span>
<span class="n">num_layers_and</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers_and</span><span class="p">)</span>
<span class="n">subtext_and</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">nodetext_and</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_and</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">node_positions_and</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">num_layers_and</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">subtext_and</span> <span class="o">=</span> <span class="s1">&#39;Threshold: 1.5&#39;</span>
        <span class="n">netplot</span><span class="o">.</span><span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_layers_and</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">,</span> <span class="n">subtext</span><span class="o">=</span><span class="n">subtext_and</span><span class="p">,</span> <span class="n">nodetext</span><span class="o">=</span><span class="n">nodetext_and</span><span class="p">)</span>

<span class="c1"># Draw Connections with Weights for the AND network</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">input_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_and</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">input_to_output_weights_and</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions_and</span><span class="p">,</span> <span class="n">input_node</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;AND network with threshold&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a6757e258ef274286b122839b25fd530a3dcaec21cecdcba7da706906e3a37aa.png" src="_images/a6757e258ef274286b122839b25fd530a3dcaec21cecdcba7da706906e3a37aa.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="lab-question-3">
<h2><font color='red'>Lab question 3</font><a class="headerlink" href="#lab-question-3" title="Link to this heading">#</a></h2>
<p>(a) Explain how this network implements AND. Remember, when we set a threshold, it means that if the input reaches that value, the node will have an activation of 1.0; otherwise, it will have an activation of 0.0.</p>
<p>(b) Generate a different set of weights that will give the same result; you may have to change the threshold.</p>
</section>
<hr class="docutils" />
<section id="id1">
<h2>Checking the network outputs<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>As we did for OR, we can write a simple function to test the outputs this network will give to all possible 1,0 combinations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">and_network</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">):</span>
    <span class="n">weight1</span><span class="p">,</span> <span class="n">weight2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="c1"># Weights for the input nodes</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Threshold for activation</span>

    <span class="c1"># Compute the weighted sum</span>
    <span class="n">weighted_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">input1</span> <span class="o">*</span> <span class="n">weight1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">input2</span> <span class="o">*</span> <span class="n">weight2</span><span class="p">)</span>

    <span class="c1"># Check if the weighted sum meets or exceeds the threshold</span>
    <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">weighted_sum</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">output</span>

<span class="c1"># Test the network on all possible input combinations</span>
<span class="n">input_combinations</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="n">input_combinations</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">and_network</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="n">inputs</span><span class="si">}</span><span class="s2">, Output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input: (0, 0), Output: 0
Input: (0, 1), Output: 0
Input: (1, 0), Output: 0
Input: (1, 1), Output: 1
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<b>Note:</b> <i>When we set the threshold to 1.5 for AND, this is larger than it has to be, isn't it? We could have set it to 1.000001, which is a sum that could only be exceeded if both inputs were 1. We generally use a larger threshold that makes things quite clear. In practice, if you had any possibility of noisy inputs (e.g., values ranging from 0.9 to 1.1 for 'True' and from 0 to 0.1 for 'False'), you would want to set the threshold small enough to capture cases where both values are True but low (0.9, 0.9) but also high enough to exclude cases where one input has a high value for False (0.1) and the other has a high value for True (1.1). </i></div></section>
<hr class="docutils" />
<section id="a-nand-network">
<h2>A NAND network<a class="headerlink" href="#a-nand-network" title="Link to this heading">#</a></h2>
<p>Now let’s make a network for NAND – ‘not AND’. What should the truth table look like? It should have <em>opposite</em> outputs when compared to the AND truth table. Remember, here’s what the <strong>AND truth table</strong> looks like:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Output (A AND B)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p><font color='red'>False</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p><font color='red'>False</font></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p><font color='red'>False</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p><font color='darkgreen'>True</font></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="nand-truth-tables">
<h2>NAND truth tables<a class="headerlink" href="#nand-truth-tables" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Output (A NAND B)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p><font color='darkgreen'>True</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>False</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p><font color='darkgreen'>True</font></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p><font color='darkgreen'>True</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>True</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p><font color='red'>False</font></p></td>
</tr>
</tbody>
</table>
</div>
<p>The output is <strong>false</strong> only when both inputs are true.</p>
<p>Here it is rewritten with 1s and 0s.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Input A</p></th>
<th class="head text-center"><p>Input B</p></th>
<th class="head text-center"><p>Output (A NAND B)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p><strong>1</strong></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p><strong>1</strong></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p><strong>1</strong></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p><strong>0</strong></p></td>
</tr>
</tbody>
</table>
</div>
<p>Do you see why? We are defining a function that gives a 1 when AND is <strong>not</strong> true, and 0 otherwise.</p>
<p>Let’s make a network for the NAND function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">network_plotter</span> <span class="k">as</span> <span class="nn">netplot</span>

<span class="c1"># Setup for the NAND network plot</span>
<span class="n">plot_width_nand</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">plot_height_nand</span> <span class="o">=</span> <span class="n">plot_width_nand</span>
<span class="n">fig_width_nand</span> <span class="o">=</span> <span class="n">plot_width_nand</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">fig_height_nand</span> <span class="o">=</span> <span class="n">fig_width_nand</span>
<span class="n">figsize_nand</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width_nand</span><span class="p">,</span> <span class="n">fig_height_nand</span><span class="p">)</span>

<span class="c1"># Define the network for the NAND function</span>
<span class="n">layers_nand</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Input 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Output&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Set weights for the NAND function</span>
<span class="c1"># Weights need to be negative to represent the NOT operation</span>
<span class="c1"># The threshold is set below zero to ensure activation unless both inputs are 1</span>
<span class="n">input_to_output_weights_nand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">threshold_nand</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>

<span class="c1"># Creating the figure for the NAND network</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize_nand</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_width_nand</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_height_nand</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

<span class="c1"># Calculate node positions for the NAND network</span>
<span class="n">node_positions_nand</span> <span class="o">=</span> <span class="n">netplot</span><span class="o">.</span><span class="n">calculate_node_positions</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">,</span> <span class="n">plot_width_nand</span><span class="p">,</span> <span class="n">fig_width_nand</span><span class="p">,</span> <span class="n">fig_height_nand</span><span class="p">)</span>

<span class="c1"># Draw Neurons with Labels for the NAND network</span>
<span class="n">num_layers_nand</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">)</span>
<span class="n">subtext_nand</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">node_positions_nand</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">num_layers_nand</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">subtext_nand</span> <span class="o">=</span> <span class="s1">&#39;Threshold: -1.5&#39;</span>
        <span class="n">netplot</span><span class="o">.</span><span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_layers_nand</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width_nand</span><span class="p">,</span> <span class="n">subtext</span><span class="o">=</span><span class="n">subtext_nand</span><span class="p">)</span>

<span class="c1"># Draw Connections with Weights for the NAND network</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">input_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">input_to_output_weights_nand</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions_nand</span><span class="p">,</span> <span class="n">input_node</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width_nand</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NAND network with threshold&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8d71107a2028d1acddbe072f747d00262a5d05039628d9e567005d6eb4d68bac.png" src="_images/8d71107a2028d1acddbe072f747d00262a5d05039628d9e567005d6eb4d68bac.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to test the NAND network</span>
<span class="k">def</span> <span class="nf">nand_network</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">):</span>
    <span class="n">weight1</span><span class="p">,</span> <span class="n">weight2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="c1"># Negative weights for the NAND operation</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>  <span class="c1"># Threshold for activation</span>

    <span class="c1"># Compute the weighted sum</span>
    <span class="n">weighted_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">input1</span> <span class="o">*</span> <span class="n">weight1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">input2</span> <span class="o">*</span> <span class="n">weight2</span><span class="p">)</span>

    <span class="c1"># Check if the weighted sum meets or exceeds the threshold</span>
    <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">weighted_sum</span> <span class="o">&gt;=</span> <span class="n">threshold</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">output</span>

<span class="c1"># Test the network on all possible input combinations</span>
<span class="n">input_combinations_nand</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">test_results_nand</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="n">input_combinations_nand</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">nand_network</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">test_results_nand</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">inputs</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="n">inputs</span><span class="si">}</span><span class="s2">, Output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># alternative, less human-readable way to print results</span>
<span class="c1">#test_results_nand</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input: (0, 0), Output: 1
Input: (0, 1), Output: 1
Input: (1, 0), Output: 1
Input: (1, 1), Output: 0
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="lab-question-4">
<h2><font color='red'>Lab question 4</font><a class="headerlink" href="#lab-question-4" title="Link to this heading">#</a></h2>
<p>This is interesting – we can just change the sign on the weights and threshold from the AND network and we have implemented NAND! (Note that changing the sign will not work with all possible weights, because in the AND case, increasing weights pushes us further beyond the threshold; but for NAND, more negative weights would push us <strong>below</strong> the threshold; we would have to <em>increase</em> the weights if we keep the -1.5 threshold, i.e., move them closer to 0.)</p>
<p>(a) Explain why these weights work.</p>
<p>(b) Find other weights that will work; you may have to change the threshold. (Hint: if you solved this for AND, think about how we changed the example weights and threshold from AND for NAND…)</p>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="introducing-the-concept-of-bias-nodes">
<h1>Introducing the concept of <font color='red'>Bias</font> nodes<a class="headerlink" href="#introducing-the-concept-of-bias-nodes" title="Link to this heading">#</a></h1>
<p>So far, we have been setting the threshold on our decision node. This works fine, when we can set the value by hand. This will be impractical for larger problems. It would be nice to have an alternative way to set the threshold, <em>and to make it tunable</em>. That is, if we want to eventually work with networks that learn, it will be helpful to have a way for the network to learn what thresholds to use. The standard way to do this is by using <em>bias nodes</em>.</p>
<section id="understanding-bias-nodes-in-neural-networks">
<h2>Understanding bias nodes in neural networks<a class="headerlink" href="#understanding-bias-nodes-in-neural-networks" title="Link to this heading">#</a></h2>
<p>We can think of bias nodes very simply as additional inputs that help in setting  thresholds for other nodes. Let’s start with this way of thinking, and then move on to a geometric visualization.</p>
</section>
<section id="parameters-for-bias-nodes">
<h2>Parameters for bias nodes<a class="headerlink" href="#parameters-for-bias-nodes" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Bias Node</strong>: A constant input (usually 1) that is connected to specific nodes (often, all non-input nodes in a network, or all nodes within a specific layer). That is, no matter what the other inputs are, the bias node always gets the same input.</p></li>
<li><p><strong>Threshold Setting</strong>: The bias node allows for shifting the activation function to the left (negatively) or right (positively), which is like setting thresholds like we did above.</p></li>
</ul>
</section>
<section id="example-and">
<h2>Example: AND<a class="headerlink" href="#example-and" title="Link to this heading">#</a></h2>
<p>Remember that above we found that we can set the weights from Input 1 and Input 2 both to 1, and then set the Output threshold to 1.5 to implement AND.</p>
<p>When we set the threshold, we are saying that the Output node has a <em>step function</em> for its activation function: the output is 0 if the node’s total inputs are less than or equal to the threshold, or 1.0 if the node’s total inputs are greater than the threshold.</p>
<p>Let’s see how we can re-implement this using a bias node. First, we will set a new activation function for our Output node. It will still be a step function, but now we will say the output is 0.0 unless the node’s input is greater than zero.</p>
<div class="alert alert-block alert-info">
<b>Note:</b> <i>This may seem a little like cheating -- we are still setting a threshold. However, now we are going to use the same threshold all the time, and the bias node and its weighted connection to the output node will effectively change the <b>functional</b> threshold as needed for different tasks (the output node's threshold does not change, but a strong negative weight from the bias node, for example, functions like setting the threshold to a higher positive value because the input nodes now have to transmit enough activation to overcome the negative impact from the bias node). Eventually, when we have networks that learn, we will be able to tune the weights from bias nodes to set task-appropriate thresholds emergently.</i></div>
<p>The bias node will always get an input of 1.0. Now we want to figure out a weight we can use that will have the same effect as our previous approach of setting the output node’s response threshold to 1.5. Let’s try to do this while keeping the weights from Input 1 and Input 2 to the Output node both 1.0.</p>
<p>We could try setting the bias weight to 1.5. However, if we do this, then we will always be adding 1.5 to the output node’s input. If the output node is going to ‘fire’ when its input is &gt; 0, this would just make it fire all the time.</p>
<p>The reason 1.5 worked as a threshold was we were setting the value large enough that it could only be reached if both input nodes had values of 1. So now we want a value that will only allow the output node to fire when both inputs are 1. It will fire if its value is &gt; 0. So we want a value to come from the weighted bias connection that will keep the output node value at or below 0 unless both inputs are 1.</p>
<p>We can do this by setting the weight to <em>negative</em> 1.5 (-1.5)…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">network_plotter</span> <span class="k">as</span> <span class="nn">netplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Setup for the AND network plot</span>
<span class="n">plot_width</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">plot_height</span> <span class="o">=</span> <span class="n">plot_width</span>
<span class="n">fig_width</span> <span class="o">=</span> <span class="n">plot_width</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">fig_height</span> <span class="o">=</span> <span class="n">fig_width</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Define the network for the AND function</span>
<span class="n">layers_and</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Input 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Bias&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Output&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Set weights for the AND function</span>
<span class="c1"># Both inputs need to be 1 to exceed the threshold of 1.5</span>
<span class="n">input_to_output_weights_and</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>

<span class="c1"># Creating the figure for the AND network</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

<span class="c1"># Calculate node positions for the AND network</span>
<span class="n">node_positions_and</span> <span class="o">=</span> <span class="n">netplot</span><span class="o">.</span><span class="n">calculate_node_positions</span><span class="p">(</span><span class="n">layers_and</span><span class="p">,</span> <span class="n">plot_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Draw Neurons with Labels for the AND network</span>
<span class="n">num_layers_and</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers_and</span><span class="p">)</span>
<span class="n">subtext_and</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">nodetext_and</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_and</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">node_positions_and</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="c1"># if i == num_layers_and - 1:</span>
        <span class="c1">#     subtext_and = &#39;Threshold: 1.5&#39;</span>
        <span class="n">netplot</span><span class="o">.</span><span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_layers_and</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">,</span> <span class="n">subtext</span><span class="o">=</span><span class="n">subtext_and</span><span class="p">,</span> <span class="n">nodetext</span><span class="o">=</span><span class="n">nodetext_and</span><span class="p">)</span>

<span class="c1"># Draw Connections with Weights for the AND network</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">input_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_and</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">input_to_output_weights_and</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions_and</span><span class="p">,</span> <span class="n">input_node</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;AND network with bias node to set threshold&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/baf48618858101442bac0cc5b76acd8032772924eae7b35af93623a11ccacd6e.png" src="_images/baf48618858101442bac0cc5b76acd8032772924eae7b35af93623a11ccacd6e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">and_network_with_bias</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">weight_input1</span><span class="p">,</span> <span class="n">weight_input2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="c1"># Weights for the input nodes</span>
    <span class="n">weight_bias</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>  <span class="c1"># Weight for the bias node</span>

    <span class="c1"># Compute the weighted sum including the bias</span>
    <span class="n">weighted_sum</span> <span class="o">=</span> <span class="n">input1</span> <span class="o">*</span> <span class="n">weight_input1</span> <span class="o">+</span> <span class="n">input2</span> <span class="o">*</span> <span class="n">weight_input2</span> <span class="o">+</span> <span class="n">bias</span> <span class="o">*</span> <span class="n">weight_bias</span>

    <span class="c1"># The output is 1 if the weighted sum is positive, else 0</span>
    <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">weighted_sum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">output</span>

<span class="c1"># Test the network with bias on all possible input combinations</span>
<span class="n">input_combinations</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="n">input_combinations</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">and_network_with_bias</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="n">inputs</span><span class="si">}</span><span class="s2">, Output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input: (0, 0), Output: 0
Input: (0, 1), Output: 0
Input: (1, 0), Output: 0
Input: (1, 1), Output: 1
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="using-bias-to-set-thresholds">
<h2>Using Bias to Set Thresholds<a class="headerlink" href="#using-bias-to-set-thresholds" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>The bias is always on</strong>: Remember, the bias node gets a constant input (usually 1.0; we assume that value unless we are told it is different).</p></li>
<li><p><strong>Bias weight</strong>: By adjusting the weight of the bias node, you can tweak the threshold at which the neuron activates. Remember, the threshold on the output node is set to 0.0 – it ‘fires’ if the input is greater than 0.0. The bias node adds a value (a negative value in the case of AND) that effectively shifts the threshold. We set the bias-to-output weight to -1.5 for the AND network. Since the input to the bias node is always 1, there is a constant value of -1.5 added to the output node’s input. Therefore, the summed values from the inputs multiplied by their weights have to exceed 1.5 before the total input to the output node exceeds 0.0.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="nand-with-a-bias-node">
<h2>NAND with a bias node<a class="headerlink" href="#nand-with-a-bias-node" title="Link to this heading">#</a></h2>
<p>Now let’s just replot the NAND network with a bias node.</p>
<p>The same principle we saw before applies – we will change the signs on the weights to achieve the opposite of AND.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">network_plotter</span> <span class="k">as</span> <span class="nn">netplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Setup for the nand network plot</span>
<span class="n">plot_width</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">plot_height</span> <span class="o">=</span> <span class="n">plot_width</span>
<span class="n">fig_width</span> <span class="o">=</span> <span class="n">plot_width</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">fig_height</span> <span class="o">=</span> <span class="n">fig_width</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Define the network for the nand function</span>
<span class="n">layers_nand</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Input 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Input 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Bias&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Output&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Set weights for the nand function</span>
<span class="c1"># Both inputs need to be 1 to exceed the threshold of 1.5</span>
<span class="n">input_to_output_weights_nand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>

<span class="c1"># Creating the figure for the nand network</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

<span class="c1"># Calculate node positions for the nand network</span>
<span class="n">node_positions_nand</span> <span class="o">=</span> <span class="n">netplot</span><span class="o">.</span><span class="n">calculate_node_positions</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">,</span> <span class="n">plot_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

<span class="c1"># Draw Neurons with Labels for the nand network</span>
<span class="n">num_layers_nand</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">)</span>
<span class="n">subtext_nand</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">nodetext_nand</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">node_positions_nand</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="c1"># if i == num_layers_nand - 1:</span>
        <span class="c1">#     subtext_nand = &#39;Threshold: 1.5&#39;</span>
        <span class="n">netplot</span><span class="o">.</span><span class="n">draw_neuron_with_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_layers_nand</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">,</span> <span class="n">subtext</span><span class="o">=</span><span class="n">subtext_nand</span><span class="p">,</span> <span class="n">nodetext</span><span class="o">=</span><span class="n">nodetext_nand</span><span class="p">)</span>

<span class="c1"># Draw Connections with Weights for the nand network</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">input_node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers_nand</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">input_to_output_weights_nand</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">netplot</span><span class="o">.</span><span class="n">draw_connection_with_weight</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_positions_nand</span><span class="p">,</span> <span class="n">input_node</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">show_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NAND network with bias node to set threshold&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d76bee8b269ec5870b53b00a0d2c3094dffb43815a756570777392db190d5c2a.png" src="_images/d76bee8b269ec5870b53b00a0d2c3094dffb43815a756570777392db190d5c2a.png" />
</div>
</div>
<hr class="docutils" />
<section id="using-bias-to-set-thresholds-reprised">
<h3>Using Bias to Set Thresholds, reprised<a class="headerlink" href="#using-bias-to-set-thresholds-reprised" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Now we set the bias-to-output weight to 1.5 for the NAND network and the input-to-output weights both to -1. Since the input to the bias node is always 1, there is a constant value of 1.5 sent to the output node. Therefore, if only one of the two input nodes is on, -1 + 1.5 will be 0.5, which is greater than 0, so the output node will take the value 1. The only case where it will be 0 (false) is when both inputs are 1 (giving input of -2 from the inputs, which will make the raw value for the output node -0.5, which is less than zero.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="understanding-the-role-of-bias-in-a-2d-problem">
<h1>Understanding the Role of Bias in a 2D Problem<a class="headerlink" href="#understanding-the-role-of-bias-in-a-2d-problem" title="Link to this heading">#</a></h1>
<p>In the context of machine learning and neural networks, the concept of bias is crucial for understanding what kinds of functions networks can compute. Let’s explore this concept using the simple example of a line in 2D space.</p>
<section id="equation-of-a-line-2d">
<h2>Equation of a Line (2D)<a class="headerlink" href="#equation-of-a-line-2d" title="Link to this heading">#</a></h2>
<p>The general equation of a line is: <span class="math notranslate nohighlight">\( y = mx + b \)</span></p>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y\)</span> is the output.</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the slope of the line.</p></li>
<li><p><span class="math notranslate nohighlight">\(x\)</span> is the input.</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> is the intercept, or bias.</p></li>
</ul>
</section>
<section id="without-bias">
<h2>Without bias<a class="headerlink" href="#without-bias" title="Link to this heading">#</a></h2>
<p>If <span class="math notranslate nohighlight">\(b\)</span> is set to 0, we get:  <span class="math notranslate nohighlight">\( y = mx + 0\)</span></p>
<p>So we can simplify this and drop the bias term (<span class="math notranslate nohighlight">\(b\)</span>): <span class="math notranslate nohighlight">\( y = mx \)</span></p>
<section id="limitations-without-bias">
<h3>Limitations without bias<a class="headerlink" href="#limitations-without-bias" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Without bias, the line will always pass through the origin (0,0).</p></li>
<li><p>This limits the model’s ability to fit data that is not centered around the origin.</p></li>
</ul>
</section>
</section>
<section id="with-bias">
<h2>With bias<a class="headerlink" href="#with-bias" title="Link to this heading">#</a></h2>
<p>Including the bias term allows the line to shift up or down – it is the intercept.</p>
<section id="overcoming-limitations-with-bias">
<h3>Overcoming limitations with bias<a class="headerlink" href="#overcoming-limitations-with-bias" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The bias term (<span class="math notranslate nohighlight">\(b\)</span>) allows the line to intercept the y-axis at a point other than the origin.</p></li>
<li><p>This provides flexibility to the model, enabling it to fit a wider range of data.</p></li>
</ul>
</section>
</section>
<section id="python-example">
<h2>Python example<a class="headerlink" href="#python-example" title="Link to this heading">#</a></h2>
<p>The following Python code demonstrates the difference between a line with and without bias (intercept):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Parameters</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Slope</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># Bias</span>

<span class="c1"># Data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Line without bias</span>
<span class="n">y_no_bias</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">x</span>

<span class="c1"># Line with bias</span>
<span class="n">y_with_bias</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_no_bias</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Without Bias (y = mx)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_with_bias</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;With Bias (y = mx + b)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>  <span class="c1"># Horizontal grey dashed line at y=0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>  <span class="c1"># Vertical grey dashed line at x=0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Effect of Bias (intercept!) in a 2D Line&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Input (x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Output (y)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1453bfaab8c0cb8a071a6c97afb155d80f956d808d71dbc02bafd860cfa19b8.png" src="_images/d1453bfaab8c0cb8a071a6c97afb155d80f956d808d71dbc02bafd860cfa19b8.png" />
</div>
</div>
<section id="what-does-this-have-to-do-with-logic">
<h3>What does this have to do with logic?<a class="headerlink" href="#what-does-this-have-to-do-with-logic" title="Link to this heading">#</a></h3>
<p>Let’s think about our logical functions geometrically. First, let’s make a plot of the AND problem. The case where we want the network to output True (1) is the blue point. The other cases, where we want the output to be False (0), are red Xs. I’ve made the axes wider than seems necessary in anticipation of things I want to show you on some later plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Possible inputs and corresponding outputs for AND operation</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Plotting the inputs</span>
<span class="k">for</span> <span class="n">point</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Output 1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Output 0</span>

<span class="c1"># Annotations and labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;AND inputs and outputs &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Input 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Input 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b01867a261084af03d9e19ed16fd17d1febc9339b8d8a0118193c87eec5be5fe.png" src="_images/b01867a261084af03d9e19ed16fd17d1febc9339b8d8a0118193c87eec5be5fe.png" />
</div>
</div>
<p>Okay, now let’s try to draw a linear <strong>decision boundary</strong> for AND without bias – a straight line that passes through 0,0 and separates the blue point from the red points. We’ll see that this is not possible. Let’s do this by defining a function that can take a set of input-output pairs, as well as a set of slope-bias pairs, and plot the inputs and then the lines we specify. This will allow us to call the function when we want to add new lines, or when we want to change the input-output pairs for another logical function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">plot_decision_boundaries</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">slope_bias_pairs</span><span class="p">,</span> <span class="n">ptitle</span><span class="o">=</span><span class="s1">&#39;Decision boundaries&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots decision boundaries for given inputs and outputs.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    inputs (np.array): Array of input points.</span>
<span class="sd">    outputs (np.array): Array of output values corresponding to each input point.</span>
<span class="sd">    slope_bias_pairs (list of tuples): List of tuples where each tuple is (slope, bias).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Plotting the inputs</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">point</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Output 1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Output 0</span>

    <span class="c1"># Plotting each decision boundary</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slope_bias_pairs</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Line with Slope </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1">, Bias </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">slope_bias_pairs</span><span class="p">)))</span>

    <span class="c1"># Annotations and labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">ptitle</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Input 1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Input 2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Using the function for AND</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">slope_bias_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">slope_bias_pairs</span><span class="p">,</span> <span class="n">ptitle</span><span class="o">=</span><span class="s1">&#39;Decision boundaries without bias for AND&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/52bce76a033ea4d78b4b3932c153ab1e0e2481d4052f0074ed76ef32cf653863.png" src="_images/52bce76a033ea4d78b4b3932c153ab1e0e2481d4052f0074ed76ef32cf653863.png" />
</div>
</div>
<p>So we see that each line passes through 0,0 – each line must since bias is set to 0. The way to interpret the lines is that all values on one side of the line are in one category, and the values on the other side are in the other. We want to have a line that separates the blue point from the red Xs. The line with slope of -1 (which intersects the y axis at 1 and the x axis at 1) puts 0,0 in one category, and the other 3 points in the other (what logical function does this correspond to?). The other two lines put 0,0 and one of the red Xs in one category (e.g., the line with slope 1.5 puts 0,0 and 0,1 in one category, and 1,0 and 1,1 in the other). Without bias we cannot solve this problem. However, I hope you can see that if we could draw a diagonal line parallel to the line with slope -1 but shifted up and to the right, we <em>could</em> separate the 1,1 point from the others. Let’s add a line that can do this in the next plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope_bias_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)]</span>

<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">slope_bias_pairs</span><span class="p">,</span> <span class="n">ptitle</span><span class="o">=</span><span class="s1">&#39;Decision boundary with bias for AND&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3cd0f8b36a30252af404b14abe695e578b26e28947477d418f750d7ae3f34635.png" src="_images/3cd0f8b36a30252af404b14abe695e578b26e28947477d418f750d7ae3f34635.png" />
</div>
</div>
</section>
</section>
<section id="nand-decision-space">
<h2>NAND decision space<a class="headerlink" href="#nand-decision-space" title="Link to this heading">#</a></h2>
<p>Now let’s look at NAND. We just change the <code class="docutils literal notranslate"><span class="pre">outputs</span></code> appropriately. We can keep the same bias for now, but remember that we would have to change the signs of all the weights in the actual network so that it would treat 1,1 as False (0) and all the others as True.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">slope_bias_pairs</span><span class="p">,</span> <span class="n">ptitle</span><span class="o">=</span><span class="s1">&#39;Decision boundary with bias for NAND&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e97fcfbb295f980c361e6e06b6829dfdcc844b2711ad2c3fe3869cce7737f2a5.png" src="_images/e97fcfbb295f980c361e6e06b6829dfdcc844b2711ad2c3fe3869cce7737f2a5.png" />
</div>
</div>
</section>
<section id="or-decision-space">
<h2>OR decision space<a class="headerlink" href="#or-decision-space" title="Link to this heading">#</a></h2>
<p>For OR, we are actually fine without bias, though the system would be ‘brittle’ in that it would not be able to tolerate any noise in the inputs. Thus, shifting the decision boundary up a bit would make the system more robust (the line with bias = 0.5).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">slope_bias_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>

<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">slope_bias_pairs</span><span class="p">,</span> <span class="n">ptitle</span><span class="o">=</span><span class="s1">&#39;Decision boundary with bias for OR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/99dae53b60078f56e4a307312d406c98df5690399ee8ed858e1a219cc052960b.png" src="_images/99dae53b60078f56e4a307312d406c98df5690399ee8ed858e1a219cc052960b.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="lab-question-5">
<h2><font color='red'>Lab question 5</font><a class="headerlink" href="#lab-question-5" title="Link to this heading">#</a></h2>
<p>(a) Explain what a linearly-separable mapping is.</p>
<p>(b) Explain why AND, OR and NAND are linearly separable but XOR is not.</p>
<p>(c) Explain what <em>bias</em> is in the current context. What are the limitations when bias is not available? To put this slightly differently, what can you do with bias that you cannot do without?  Explain it conceptually and also in terms of geometry.</p>
</section>
<hr class="docutils" />
<section id="a-tangent-more-implications-of-bias">
<h2>A tangent: more implications of bias<a class="headerlink" href="#a-tangent-more-implications-of-bias" title="Link to this heading">#</a></h2>
<p>Right now, we are looking at networks that do simple <em><strong>classification</strong></em> – the network tells us whether an input pair belongs to the category of True or the category of False. A more complex classification network might take in images and try to classify them as ‘Dog’ or ‘Not dog’ (or ‘Dog’ or ‘Cat’). But often we want networks to give us <em>continuous</em> outputs – for example, predicting the sale value of a house given the number of houses currently available in a particular area (a simple linear regression, with 1 predictor and 1 output), or the sale value of a house given number of available houses, square feet of the house, number of bedrooms, number of bathrooms, and location (e.g., lattitude and longitude) – which would be multiple regression (multiple predictor values [inputs] and 1 predicted output value).</p>
<p>Let’s think about the implications of bias for the simple linear prediction case – trying to predict a y value from an x value.</p>
<p>Here’s another case where <strong>pseudo-data</strong> will be very helpful. Let’s create a function that creates some pseudo data with a particular standard deviation and range, and also a relationship between x and y based on slope and bias terms. Then let’s plot the best fitting line with a bias term, and the best fitting line <em>without</em> a bias term (that has to pass through the origin,  0,0).</p>
<p>We will consider how well model fits the data in two ways. First, we will calculate an index of how much total error there is – how far in total the observed data points are from the model’s prediction. Second, we will create a function for calculating <span class="math notranslate nohighlight">\(r\)</span> (the coefficient of correlation) from a set of actual x,y values and the parameters for a line.</p>
<p>Let’s start with the error measure we will use to assess how well our lines fit the data.</p>
<hr class="docutils" />
<div class="alert alert-block alert-info">
</section>
<section id="mean-squared-error-mse">
<h2>Mean Squared Error (MSE)<a class="headerlink" href="#mean-squared-error-mse" title="Link to this heading">#</a></h2>
<p>Mean Squared Error (MSE) is a common error metric used in a variety of domains. We will use it for some neural networks later in the course. But the basic idea is we have a set of predicted data points and a set of actual data points, and we want to characterize how far off the predictions are. We can’t just sum the error, because some will be positive and some will be negative. We could take the <strong>m</strong>ean <strong>a</strong>bsolute values of the <strong>e</strong>rrors (MAE). However, MSE has advantages (it’s differentiable everywhere, which will be important for neural net applications; it emphasizes larger errors since we square the values; it is less biased than MAE [for reasons outside the scope of this class]; it’s directly related to variance which makes it conceptually compatible with a variety of concepts in statistics, etc.).</p>
<section id="the-formula-to-calculate-mse-is">
<h3>The formula to calculate MSE is:<a class="headerlink" href="#the-formula-to-calculate-mse-is" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
\text{MSE} = \frac{1}{n}\sum_{i=1}^{n}(Y_i - \hat{Y_i})^2
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( n \)</span> is the number of data points (multiplying by <span class="math notranslate nohighlight">\(1/n\)</span> gives us the mean of the right side of the equation, which is the summed squares of the errors)</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_i \)</span> is the actual value for the <span class="math notranslate nohighlight">\(i^{th}\)</span> data point.</p></li>
<li><p><span class="math notranslate nohighlight">\( \hat{Y_i} \)</span> is the predicted value for the <span class="math notranslate nohighlight">\(i^{th}\)</span> data point.</p></li>
</ul>
<p>The differences are squared to avoid the canceling out of positive and negative errors. The mean of these squared differences gives us the MSE.</p>
</div><hr class="docutils" />
<p>Now let’s do the plotting function and compare MSE with lines of best fit (that use intercept or bias terms) vs. lines that do not have an intercept (bias) and therefore must pass through the origin (0,0).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># This block just defines the function but doesn&#39;t do anything -- you have to call it, </span>
<span class="c1"># e.g.: plot_regression_through_origin(sd=30.0, b=300.0, m=-10.0, minval=-1, maxval=50, nval=100)</span>

<span class="c1"># Note that I started off on a rabbit hole of thinking about R values for lines of best fit. </span>
<span class="c1"># What really matters is error, which we will characterize as Mean Squared Error -- or MSE. </span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">calculate_r_from_line</span><span class="p">(</span><span class="n">actual_x</span><span class="p">,</span> <span class="n">actual_y</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Pearson correlation coefficient (R) between actual y values and y values predicted by a line.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    actual_x (np.array): Array of x values.</span>
<span class="sd">    actual_y (np.array): Array of actual y values.</span>
<span class="sd">    slope (float): Slope of the line (model).</span>
<span class="sd">    intercept (float): Intercept of the line (model).</span>

<span class="sd">    Returns:</span>
<span class="sd">    float: Pearson correlation coefficient (R).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculating predicted y values using the line equation</span>
    <span class="n">predicted_y</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">actual_x</span> <span class="o">+</span> <span class="n">intercept</span>

    <span class="c1"># Calculating Pearson&#39;s R</span>
    <span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">actual_y</span><span class="p">,</span> <span class="n">predicted_y</span><span class="p">)</span>
    <span class="n">pearsons_r</span> <span class="o">=</span> <span class="n">correlation_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># or correlation_matrix[1, 0] as the matrix is symmetric</span>
    <span class="n">pearsons_r</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="c1"># </span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="c1"># Plotting actual vs. predicted values</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">actual_x</span><span class="p">,</span> <span class="n">actual_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual Y Values&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">actual_x</span><span class="p">,</span> <span class="n">predicted_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted Y Values&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual vs. Predicted Y Values&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X Values&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y Values&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Slope = </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, Intercept = </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, R = </span><span class="si">{</span><span class="n">pearsons_r</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">actual_y</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pearsons_r</span><span class="p">,</span> <span class="n">predicted_y</span>

<span class="k">def</span> <span class="nf">plot_regression_through_origin</span><span class="p">(</span><span class="n">sd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">minval</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                  <span class="n">rseed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figwidth</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">figheight</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">ptitle</span><span class="o">=</span><span class="s2">&quot;Pseudo data with lines of best fit&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a plot of pseudo data with a best fit line and a line through the origin.</span>
<span class="sd">    A red square is plotted at 0,0.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    sd (float): Standard deviation of the noise.</span>
<span class="sd">    b (float): Intercept of the pseudo data line.</span>
<span class="sd">    m (float): Slope of the pseudo data line.</span>
<span class="sd">    minval (float): Minimum value of x in the pseudo data.</span>
<span class="sd">    maxval (float): Maximum value of x in the pseudo data.</span>
<span class="sd">    nval (int): Number of values in the pseudo data.</span>
<span class="sd">    rseed (int): random seed that can be set for reproducibility</span>
<span class="sd">    figwidth (float): figure width</span>
<span class="sd">    figheight (float): figure height </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Seed for reproducibility and generating pseudo data</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>

    <span class="c1"># Generating pseudo data</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minval</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">nval</span><span class="p">)</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">x_data</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sd</span><span class="p">,</span> <span class="n">x_data</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># Calculating the best fit line with intercept</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
    <span class="n">y_fit</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x_data</span> <span class="o">+</span> <span class="n">intercept</span>

    <span class="c1"># Calculating the best fitting line through the origin</span>
    <span class="n">slope_origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x_data</span> <span class="o">*</span> <span class="n">y_data</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x_data</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">y_fit_origin</span> <span class="o">=</span> <span class="n">slope_origin</span> <span class="o">*</span> <span class="n">x_data</span>

    <span class="c1"># ** not bothering with these anymore... ** </span>
    <span class="c1"># Calculating R value for the line through the origin</span>
    <span class="c1"># Adjusted R-squared calculation</span>
    <span class="c1"># rss_origin = np.sum((y_data - y_fit_origin) ** 2)</span>
    <span class="c1"># tss_origin = np.sum(y_data**2)  # Total sum of squares from the origin</span>
    <span class="c1"># r_value_origin = np.sqrt(1 - rss_origin / tss_origin)  # Adjusted R-squared</span>
    <span class="c1"># # Adjusting the sign of R based on the slope</span>
    <span class="c1"># r_value_origin *= np.sign(slope_origin)</span>
    
    
    <span class="c1"># alternative method for calculating R, since other version is problematic</span>
    <span class="c1"># (was not actually problematic... but no longer using this for R; </span>
    <span class="c1">#  however, still using it to get the predicted values from the line </span>
    <span class="c1">#  equations so we can calculate MSE)</span>
    <span class="c1"># Parameters for the line (best)</span>
    <span class="n">alt_r_best</span><span class="p">,</span> <span class="n">pred_best</span> <span class="o">=</span> <span class="n">calculate_r_from_line</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>
    <span class="n">alt_r_origin</span><span class="p">,</span> <span class="n">pred_origin</span> <span class="o">=</span> <span class="n">calculate_r_from_line</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">slope_origin</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># MSE calculation</span>
    <span class="n">mse_best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_data</span> <span class="o">-</span> <span class="n">pred_best</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">mse_origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_data</span> <span class="o">-</span> <span class="n">pred_origin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">mse_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">mse_origin</span><span class="o">-</span><span class="n">mse_best</span><span class="p">)</span> <span class="o">/</span> <span class="n">mse_best</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">mse_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">mse_origin</span><span class="o">/</span><span class="n">mse_best</span><span class="p">)</span>
    
    <span class="c1"># Plotting</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figwidth</span><span class="p">,</span> <span class="n">figheight</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pseudo Data&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_fit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Best Fit (y = </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">x + </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_fit_origin</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Line Through Origin (y = </span><span class="si">{</span><span class="n">slope_origin</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">x)&#39;</span><span class="p">)</span>

    <span class="c1"># let&#39;s highlight the origin with a special mark and dashed lines. </span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Point at Origin (0,0)&#39;</span><span class="p">)</span>  <span class="c1"># Red square at the origin</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>  <span class="c1"># Horizontal grey dashed line at y=0</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>  <span class="c1"># Vertical grey dashed line at x=0</span>
    
    <span class="c1"># Title and labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">ptitle</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Input (x)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Output (y)&#39;</span><span class="p">)</span>

    <span class="c1"># Placing the legend and R value annotations</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;MSE ( best )=</span><span class="si">{</span><span class="n">mse_best</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;MSE (origin)=</span><span class="si">{</span><span class="n">mse_origin</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.825</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;MSE increase=</span><span class="si">{</span><span class="n">mse_ratio</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> X &#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1">#return pred_best, pred_origin, y_data</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s call it with a case where we set the bias to a small value (first plot below) and then with a larger bias (second plot). Note that we plot a red square at the origin to help us see that critical point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s use it... First with a case where we get only small error with 0 bias</span>
<span class="n">plot_regression_through_origin</span><span class="p">(</span><span class="n">sd</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">m</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">minval</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ae848ee4eb994f007063b7545be1c8dea1c31e2c3d74108145b13df48ecd3021.png" src="_images/ae848ee4eb994f007063b7545be1c8dea1c31e2c3d74108145b13df48ecd3021.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s do the same thing but generate 100 values instead of 10</span>
<span class="n">plot_regression_through_origin</span><span class="p">(</span><span class="n">sd</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">m</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">minval</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3deaeba3866a311b2f9e3bc5d300abe9ff6fe169add8aed4e27bb2b16185671a.png" src="_images/3deaeba3866a311b2f9e3bc5d300abe9ff6fe169add8aed4e27bb2b16185671a.png" />
</div>
</div>
<p>The function finds the conventional best-fitting line (including a bias term) and then the best possible line through the origin (0,0). This means the line that minimizes the mean distance between the line and every data point. So the green line is showing us what our prediction would be for a new x value. We can see that for this first case (with 10 values and then 100), the 2 lines are close to equivalent (because bias in the original data is low). However, in the next case, with substantial bias in the data (100) but no bias for the prediction, we will undershoot at low values and overshoot at high values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s make the bias (intercept) in the data quite substantial: 100</span>
<span class="n">plot_regression_through_origin</span><span class="p">(</span><span class="n">sd</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">m</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">minval</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6300693b45edd4a26053a1b77d09b24369637877462b767f8b87da91dbab41fb.png" src="_images/6300693b45edd4a26053a1b77d09b24369637877462b767f8b87da91dbab41fb.png" />
</div>
</div>
<p>Now let’s look at some other cases. First, here’s one where we get a really large difference in the 2 lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_regression_through_origin</span><span class="p">(</span><span class="n">sd</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span> <span class="n">m</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">minval</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4ad23f2dbbde1d260dd696e717881b5e1cec19ded142339d5e84858eaa946157.png" src="_images/4ad23f2dbbde1d260dd696e717881b5e1cec19ded142339d5e84858eaa946157.png" />
<img alt="_images/1f201376c22d70402d0c27825b14f074ed0348d05e990bb4d060b15ee2270fed.png" src="_images/1f201376c22d70402d0c27825b14f074ed0348d05e990bb4d060b15ee2270fed.png" />
</div>
</div>
<p>Let’s also check that we get identical results when we change the sign of the slope.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_regression_through_origin</span><span class="p">(</span><span class="n">sd</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">minval</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f201376c22d70402d0c27825b14f074ed0348d05e990bb4d060b15ee2270fed.png" src="_images/1f201376c22d70402d0c27825b14f074ed0348d05e990bb4d060b15ee2270fed.png" />
</div>
</div>
<p>Now let’s look at a very important consideration here. So far, we have looked at cases where the values are mostly positive, and they are not symmetric around 0. If the values are symmetric around zero, we will get quite different relations between the lines. When this happens, the two lines have the same slope. This is because if we changed the slope of the line to rotate it clockwise (remember, it has to pass through 0,0, so we can only ‘rotate’ the line by changing the slope), we would decrease the error for negative values, but we would equally increase the error for positive values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_regression_through_origin</span><span class="p">(</span><span class="n">sd</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span> <span class="n">m</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">minval</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3dd40338c892798489f58b75972ceb75a2ac5c29bd567a250577e2a88fe38df3.png" src="_images/3dd40338c892798489f58b75972ceb75a2ac5c29bd567a250577e2a88fe38df3.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="lab-question-6">
<h2><font color='red'>Lab question 6</font><a class="headerlink" href="#lab-question-6" title="Link to this heading">#</a></h2>
<p>(a) Explain what bias can do for fitting continously-valued 2d data (x, y pairs) (or conversely, what you cannot do without a bias term). Explain it conceptually and also in terms of geometry.</p>
<hr class="docutils" />
</section>
<hr class="docutils" />
<section id="conclusions-about-bias">
<h2>Conclusions about bias<a class="headerlink" href="#conclusions-about-bias" title="Link to this heading">#</a></h2>
<p>To sum up: bias nodes provide us with a general tool that can shift the intercept of a function computed by a network. Since a bias node has a constant input (usually 1.0) and so is <em>always ‘on’</em>, we can use general methods for tuning weights to adjust the value of the weight and therefore effectively set a task-appropriate threshold.</p>
<p>In the next notebook, we will start looking at ways to train networks. Then we will finally move on to the XOR function.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="10_netsci-01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Network Science Overview</p>
      </div>
    </a>
    <a class="right-next"
       href="12_nnets-02-training-linear-networks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Neural networks, Part 2 – training networks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Neural networks, Part 1: Linear logic functions as networks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-1-mystery-network"><font color="red">Lab question 1: mystery network</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-aside">An aside</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-visualize-visualize">Visualize, visualize, visualize</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-logical-function-networks">Back to logical function networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#or">OR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#truth-table-for-nonexclusive-or">Truth table for nonexclusive OR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-network-for-nonexclusive-or">A network for nonexclusive OR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-2"><font color="red">Lab question 2</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-network-outputs">Checking the network outputs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-and-network">An AND network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-3"><font color="red">Lab question 3</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Checking the network outputs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-nand-network">A NAND network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nand-truth-tables">NAND truth tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-4"><font color="red">Lab question 4</font></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-concept-of-bias-nodes">Introducing the concept of <font color="red">Bias</font> nodes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-bias-nodes-in-neural-networks">Understanding bias nodes in neural networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-for-bias-nodes">Parameters for bias nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-and">Example: AND</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bias-to-set-thresholds">Using Bias to Set Thresholds</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nand-with-a-bias-node">NAND with a bias node</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bias-to-set-thresholds-reprised">Using Bias to Set Thresholds, reprised</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-role-of-bias-in-a-2d-problem">Understanding the Role of Bias in a 2D Problem</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equation-of-a-line-2d">Equation of a Line (2D)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#without-bias">Without bias</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-without-bias">Limitations without bias</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#with-bias">With bias</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overcoming-limitations-with-bias">Overcoming limitations with bias</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-example">Python example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-this-have-to-do-with-logic">What does this have to do with logic?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nand-decision-space">NAND decision space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#or-decision-space">OR decision space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-5"><font color="red">Lab question 5</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-tangent-more-implications-of-bias">A tangent: more implications of bias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-squared-error-mse">Mean Squared Error (MSE)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-formula-to-calculate-mse-is">The formula to calculate MSE is:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-question-6"><font color="red">Lab question 6</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions-about-bias">Conclusions about bias</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By James Magnuson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>